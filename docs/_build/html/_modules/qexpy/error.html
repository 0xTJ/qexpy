

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>qexpy.error &mdash; QExPy 0.1.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="QExPy 0.1.1 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> QExPy
          

          
          </a>

          
            
            
              <div class="version">
                0.0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uncertainties.html">Error Propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations.html">Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../measurement.html">The Measurement Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../measurement_arr.html">The MeasurementArray Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plot.html">The Plot Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../xyfitter.html">The XYFitter Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../xydataset.html">The XYDataset Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LICENSE.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QExPy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>qexpy.error</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for qexpy.error</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1">#used for the histograms, will remove when move bokeh histo to </span>
<span class="c1">#to use Plot():</span>
<span class="kn">import</span> <span class="nn">bokeh.plotting</span> <span class="k">as</span> <span class="nn">bp</span>
<span class="kn">import</span> <span class="nn">bokeh.io</span> <span class="k">as</span> <span class="nn">bi</span>
<span class="c1">#used for array and number types:</span>
<span class="kn">import</span> <span class="nn">qexpy.utils</span> <span class="k">as</span> <span class="nn">qu</span>
<span class="c1">#used to check plot_engine:</span>
<span class="kn">import</span> <span class="nn">qexpy</span> <span class="k">as</span> <span class="nn">q</span>
<span class="kn">import</span> <span class="nn">re</span>


<span class="k">class</span> <span class="nc">ExperimentalValue</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Root class of objects which contains a mean and standard deviation.</span>
<span class="sd">    From this class, objects with properties pertaining to their use or</span>
<span class="sd">    formulation can be instanced. (ie. the result of an operation of</span>
<span class="sd">    measured values, called Function and Measurement respectivly)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">error_method</span> <span class="o">=</span> <span class="s2">&quot;Derivative&quot;</span>  <span class="c1"># Default error propogation method</span>
    <span class="n">print_style</span> <span class="o">=</span> <span class="s2">&quot;Default&quot;</span>  <span class="c1"># Default printing style</span>
    <span class="n">mc_trial_number</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># number of trial in Monte Carlo simulation</span>
    <span class="n">minmax_n</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># grid size in MinMax calculation</span>

    <span class="n">figs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">figs_on_uncertainty</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">register</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">formula_register</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">id_register</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Defining common types under single arrayclear</span>
    <span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">int64</span><span class="p">,</span> <span class="n">float64</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">int32</span><span class="p">,</span> <span class="n">float32</span>
    <span class="n">CONSTANT</span> <span class="o">=</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span> <span class="c1">#(int, float, int64, float64, int32, float32)</span>
    <span class="n">ARRAY</span> <span class="o">=</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span> <span class="c1">#(list, tuple, ndarray)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Creates a variable that contains a mean, standard deviation,</span>
<span class="sd">        and name for inputted data.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">der</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MinMax</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MC</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Formula&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[],</span>\
                <span class="s1">&#39;Function&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;operation&#39;</span><span class="p">:</span> <span class="p">(),</span> <span class="s1">&#39;variables&#39;</span><span class="p">:</span> <span class="p">()},</span> <span class="p">}</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error_on_mean</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>             
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Input must be either a single array of values,</span>
<span class="s1">                      or the central value and uncertainty in one measurement&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">error_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Input must be either a single array of values,</span>
<span class="s1">                      or the central value and uncertainty in one measurement.</span>
<span class="s1">                      </span>
<span class="s1">                      The feature of passing a list of measurements and their corresponding</span>
<span class="s1">                      uncertanties is now deprecated. Please use a MeasurementArray insted.</span>
<span class="s1">                      More info: </span>
<span class="s1">                      https://github.com/Queens-Physics/qexpy/blob/master/examples/jupyter/1_Intro_to_Error_Propagation.ipynb&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Input must be either a single array of values,</span>
<span class="s1">                      or the central value and uncertainty in one measurement&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Input must be either a single array of values,</span>
<span class="s1">                  or the central value and uncertainty in one measurement&#39;&#39;&#39;</span><span class="p">)</span>

        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">id_register</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span>
        
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MC_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="sd">&#39;&#39;&#39;The list of values generated by the Monte Carlo simulation.&#39;&#39;&#39;</span>
        
<span class="c1">###############################################################################</span>
<span class="c1"># Methods for printing or returning Measurement paramters</span>
<span class="c1">###############################################################################</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Method called when printing measurement objects.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39; = &#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Latex&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">_tex_print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">_def_print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Scientific&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">_sci_print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">unit_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_units_str</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">unit_string</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Latex&quot;</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s1">&#39;\,&#39;</span><span class="o">+</span><span class="n">unit_string</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s1">&#39; [&#39;</span><span class="o">+</span><span class="n">unit_string</span><span class="o">+</span><span class="s1">&#39;]&#39;</span>

        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">print_mc_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Prints the result of a Monte Carlo error propagation.</span>

<span class="sd">        The purpose of this method is to easily compare the results of a</span>
<span class="sd">        Monte Carlo propagation with whatever method is chosen.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Latex&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_tex_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Monte Carlo&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_def_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Monte Carlo&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Scientific&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_sci_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Monte Carlo&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">print_min_max_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Prints the result of a Min-Max method error propagation.</span>

<span class="sd">        The purpose of this method is to easily compare the results of a</span>
<span class="sd">        Min-Max propagation with whatever method is chosen to confirm that</span>
<span class="sd">        the Min-Max is the upper bound of the error.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Latex&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_tex_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Min Max&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_def_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Min Max&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Scientific&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_sci_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Min Max&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">print_deriv_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Prints the result of a Min-Max method error propagation.</span>

<span class="sd">        The purpose of this method is to easily compare the results of a</span>
<span class="sd">        Min-Max propagation with whatever method is chosen to confirm that</span>
<span class="sd">        the Min-Max is the upper bound of the error.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Latex&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_tex_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Derivative&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_def_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Derivative&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_style</span> <span class="o">==</span> <span class="s2">&quot;Scientific&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_sci_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Derivative&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Function to find the derivative of a measurement or measurement like</span>
<span class="sd">        object. By default, derivative is with respect to itself, which will</span>
<span class="sd">        always yeild 1. Operator acts by acessing the self.derivative</span>
<span class="sd">        dictionary and returning the value stored there under the specific</span>
<span class="sd">        variable inputted (ie. differentiating with respect to variable = ???)</span>

<span class="sd">        :param variable: The variable that the derivative is to be taken with respect to.</span>
<span class="sd">        :type variable: Measurement</span>

<span class="sd">        :returns: the numerical value of the derivative with respect to the variable</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">variable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> \
                <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Measurement</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;The derivative of a Measurement with respect to anything</span>
<span class="s1">                  other than a Measurement is zero.&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="k">elif</span> <span class="n">variable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;The object must be differentiated with respect to another</span>
<span class="s1">            Measurement.&#39;&#39;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">[</span><span class="n">variable</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">derivative</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">[</span><span class="n">variable</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">derivative</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;The mean of a Measurement object.</span>

<span class="sd">        :setter: Sets the mean of the Measurement.</span>
<span class="sd">        :getter: Returns the mean of the Measurement.</span>
<span class="sd">        :type: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mean</span>

    <span class="nd">@mean</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the mean of a Measurement object.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">der</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MinMax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_mean</span> <span class="o">=</span> <span class="n">mean</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean must be a number&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_mean</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Gets the standard deviation of a Measurement object.</span>

<span class="sd">        :setter: Sets the error of the Measurement.</span>
<span class="sd">        :getter: Returns the error of the Measurement.</span>
<span class="sd">        :type: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std</span>

    <span class="nd">@std</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">std</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the standard deviation of a Measurement object.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">std</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">der</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">std</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MinMax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">std</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">std</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_error_on_mean</span> <span class="o">=</span> <span class="n">std</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_data_array</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std</span> <span class="o">=</span> <span class="n">std</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Standard deviation must be a number&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">error_on_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;The error on the mean of a Measurement object.</span>

<span class="sd">        :setter: Sets the error on the mean of the Measurement object. Also updates the error on the Measurement.</span>
<span class="sd">        :getter: Returns the error on the mean of the Measurement.</span>
<span class="sd">        :type: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_on_mean</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_on_mean</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: error on mean not calculated&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@error_on_mean</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">error_on_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error_on_mean</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the error on the mean of a Measurement object.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">error_on_mean</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_error_on_mean</span> <span class="o">=</span> <span class="n">error_on_mean</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std</span> <span class="o">=</span> <span class="n">error_on_mean</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_data_array</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error on mean must be a number&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_error_on_mean</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;The name of a Measurement object.</span>

<span class="sd">        :setter: Sets the name of the Measurement object.</span>
<span class="sd">        :getter: Returns the name of the Measurement object.</span>
<span class="sd">        :type: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the name of a Measurement object.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Name must be a string&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;unnamed_var</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Measurement</span><span class="o">.</span><span class="n">id_number</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;The units of a Measurement object.</span>

<span class="sd">        :setter: Sets the units of the Measurement object.</span>
<span class="sd">        :getter: Returns the name of the Measurement object.</span>
<span class="sd">        :type: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span>

    <span class="nd">@units</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the units of a Measurement object.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="n">_parse_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">relative_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Gets the relative error (error/mean) of a Measurement object.</span>

<span class="sd">        :setter: Sets the error of the Measurement to a fraction of it&#39;s mean. </span>
<span class="sd">        :getter: Returns the error as a fraction of the mean </span>
<span class="sd">                 (ie. 0.1 corresponds to a 10% error).</span>
<span class="sd">        :type: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">!=</span><span class="mi">0</span> <span class="k">else</span> <span class="mf">0.</span> 

    <span class="nd">@relative_error</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">relative_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_error</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the relative error (error/mean) of a Measurement object.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rel_error</span><span class="p">)</span> <span class="ow">in</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">*</span><span class="n">rel_error</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Relative error must be a number&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_data_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns the underlying data array used to create the Measurement object.</span>

<span class="sd">        :returns: A python list of the data used to create the Measurement object.</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No data array exists.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_units_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Gets the units of the associated Measurement.</span>

<span class="sd">        :returns: The units of the Measurement.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">unit_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">unit_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span>
        <span class="k">if</span> <span class="n">unit_dict</span> <span class="o">!=</span> <span class="p">{}:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">unit_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">unit_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">unit_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">unit_string</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="n">unit_string</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">unit_string</span> <span class="o">+=</span> <span class="n">key</span><span class="o">+</span><span class="s1">&#39;^</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">unit_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                    <span class="n">unit_string</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>

                <span class="k">if</span> <span class="n">unit_string</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">unit_string</span> <span class="o">=</span> <span class="s1">&#39;unitless&#39;</span>
        <span class="k">return</span> <span class="n">unit_string</span>
    
    <span class="k">def</span> <span class="nf">show_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#036564&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;inline&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Creates a histogram of the inputted data using Bokeh or mpl.</span>

<span class="sd">        :param bins: The number of bins for the histogram.</span>
<span class="sd">        :type bins: int</span>
<span class="sd">        :param color: The color of the bars.</span>
<span class="sd">        :type color: str</span>
<span class="sd">        :param title: The title that will appear at the top of the histogram.</span>
<span class="sd">        :type title: str</span>
<span class="sd">        :param output: How the histogram is to be output. Can be &#39;inline&#39; or &#39;file&#39;.</span>
<span class="sd">        :type output: str</span>

<span class="sd">        :returns: The Plot object used to create the histogram.</span>
<span class="sd">        :rtype: Plot</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no data to histogram&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">hist_title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hist_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39; Histogram&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Histogram title must be a string.&#39;</span><span class="p">)</span>
            <span class="n">hist_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39; Histogram&#39;</span>                     
        
        <span class="n">data_arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">XYDataSet</span><span class="p">(</span><span class="n">xdata</span> <span class="o">=</span> <span class="n">data_arr</span><span class="p">,</span> <span class="n">is_histogram</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">data_name</span><span class="o">=</span><span class="n">hist_title</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">MakePlot</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data_arr</span><span class="p">)</span><span class="o">*.</span><span class="mi">95</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">data_arr</span><span class="p">)</span><span class="o">*</span><span class="mf">1.05</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span><span class="o">*</span><span class="mf">1.2</span><span class="p">]</span>

        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
        <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">dashed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="o">+</span><span class="n">std</span><span class="p">,</span> <span class="n">dashed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="o">-</span><span class="n">std</span><span class="p">,</span> <span class="n">dashed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span>
    
    <span class="k">def</span> <span class="nf">show_MC_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#036564&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;inline&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Creates and shows a Bokeh plot of a histogram of the values</span>
<span class="sd">        calculated by Monte Carlo error simulation.</span>

<span class="sd">        :param bins: The number of bins for the histogram.</span>
<span class="sd">        :type bins: int</span>
<span class="sd">        :param color: The color of the bars.</span>
<span class="sd">        :type color: str</span>
<span class="sd">        :param title: The title that will appear at the top of the histogram.</span>
<span class="sd">        :type title: str</span>
<span class="sd">        :param output: How the histogram is to be output. Can be &#39;inline&#39; or &#39;file&#39;.</span>
<span class="sd">        :type output: str</span>

<span class="sd">        :returns: The Plot object used to create the histogram.</span>
<span class="sd">        :rtype: Plot</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">MC_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MC_list</span>
        <span class="k">if</span> <span class="n">MC_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no MC data to histogram&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">hist_title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hist_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39; Histogram&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Histogram title must be a string.&#39;</span><span class="p">)</span>
            <span class="n">hist_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39; Histogram&#39;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">XYDataSet</span><span class="p">(</span><span class="n">xdata</span> <span class="o">=</span> <span class="n">MC_data</span><span class="p">,</span> <span class="n">is_histogram</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">data_name</span><span class="o">=</span><span class="n">hist_title</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">MakePlot</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">MC_data</span><span class="p">)</span><span class="o">*.</span><span class="mi">95</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">MC_data</span><span class="p">)</span><span class="o">*</span><span class="mf">1.05</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span><span class="o">*</span><span class="mf">1.2</span><span class="p">]</span>

        <span class="c1"># Adds a line at the mean and at the range corresponding to 68% coverage.</span>
        <span class="n">MC_mean</span><span class="p">,</span> <span class="n">MC_std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MC</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">MC_mean</span><span class="p">,</span> <span class="n">dashed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">MC_mean</span><span class="o">+</span><span class="n">MC_std</span><span class="p">,</span> <span class="n">dashed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">MC_mean</span><span class="o">-</span><span class="n">MC_std</span><span class="p">,</span> <span class="n">dashed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="k">def</span> <span class="nf">show_error_contribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#036564&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;inline&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Creates and shows a Bokeh or mpl plot of a histogram of the relative</span>
<span class="sd">        contribution of individual measurements to the variance of a calculated value.</span>
<span class="sd">        </span>
<span class="sd">        :param color: The color of the bars.</span>
<span class="sd">        :type color: str</span>
<span class="sd">        :param title: The title that will appear at the top of the histogram.</span>
<span class="sd">        :type title: str</span>
<span class="sd">        :param output: How the histogram is to be output. Can be &#39;inline&#39; or &#39;file&#39;.</span>
<span class="sd">        :type output: str</span>

<span class="sd">        :returns: The Plot object used to create the histogram.</span>
<span class="sd">        :rtype: Plot</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">formula</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Formula&#39;</span><span class="p">]</span>

        <span class="c1"># For each measurement that goes into the calculation, evaluate the calculation</span>
        <span class="c1"># at that measurement +/- the std. Take the output of that and do .5*(output-mean)^2.</span>
        <span class="c1"># Add the +std and -std term. </span>
        <span class="c1"># This process is described in this paper: http://pubs.acs.org/doi/abs/10.1021/ed1004307 </span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
            <span class="n">maxx</span> <span class="o">=</span> <span class="n">formula</span>
            <span class="n">minn</span> <span class="o">=</span> <span class="n">formula</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
                <span class="n">meas</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">register</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">name</span>
                    <span class="n">maxx</span> <span class="o">=</span> <span class="n">maxx</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">mean</span><span class="o">+</span><span class="n">meas</span><span class="o">.</span><span class="n">std</span><span class="p">))</span>
                    <span class="n">minn</span> <span class="o">=</span> <span class="n">minn</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">mean</span><span class="o">-</span><span class="n">meas</span><span class="o">.</span><span class="n">std</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">maxx</span> <span class="o">=</span> <span class="n">maxx</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">mean</span><span class="p">))</span>
                    <span class="n">minn</span> <span class="o">=</span> <span class="n">minn</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">mean</span><span class="p">))</span>
            <span class="n">terms</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">maxx</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">minn</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="c1"># Change the absolute terms into relative terms.</span>
        <span class="n">summ</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">vals</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">/</span><span class="n">summ</span>

        <span class="c1"># Add spacing to make the histogram look like a bar chart.</span>
        <span class="n">new_vals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">new_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">new_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="n">new_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">new_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">new_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        <span class="n">new_vals</span> <span class="o">=</span> <span class="n">new_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">XYDataSet</span><span class="p">(</span><span class="n">xdata</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">ydata</span><span class="o">=</span><span class="n">new_vals</span><span class="p">,</span> <span class="n">is_histogram</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">N</span><span class="p">,</span>
                    <span class="n">data_name</span><span class="o">=</span><span class="s1">&#39;Relative contribution to variance of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

        <span class="c1"># Populates the mpl figure in case it is plotted.</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">MakePlot</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_labels</span><span class="p">(</span><span class="n">xtitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ytitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">populate_mpl_figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">mplfigure_main_ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">new_names</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">mplfigure_main_ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

        <span class="c1"># Populates the boken figure in case it is plotted.</span>
        <span class="c1"># The messy stuff comes from the fact that mpl boxes, </span>
        <span class="c1"># mpl labels and bokeh boxes are 0-indexed, but mpl labels are 1 indexed.</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;xscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ydata</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="n">new_names</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">populate_bokeh_figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">bkfigure</span><span class="o">.</span><span class="n">xgrid</span><span class="o">.</span><span class="n">grid_line_color</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">bkfigure</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">major_tick_line_color</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">bkfigure</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">minor_tick_line_color</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Will use whatever plotting engine is in use.</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">populate_figure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">refresh</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Methods for Correlation and Covariance</span>
<span class="c1">###############################################################################</span>

    <span class="k">def</span> <span class="nf">_find_covariance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Uses the data from which x and y were generated to calculate</span>
<span class="sd">        covariance and add this informaiton to x and y.</span>

<span class="sd">        Requires data arrays to be stored in the .info of both objects</span>
<span class="sd">        and that these arrays are of the same length, as the covariance is</span>
<span class="sd">        only defined in these cases.</span>

<span class="sd">        :param x: A Measurement with an underlying data array the same length as y.</span>
<span class="sd">        :type x: Measurement</span>
<span class="sd">        :param y: A Measurement with an underlying data array the same length as x.</span>
<span class="sd">        :type y: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">data_x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Data&quot;</span><span class="p">]</span>
        <span class="n">data_y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Data&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">data_x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">data_y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Data arrays must exist for both quantities &quot;</span> <span class="o">+</span>
                <span class="s2">&quot;to define covariance.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_y</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Lengths of data arrays must be equal to</span><span class="se">\</span>
<span class="s1">                      define a covariance&#39;</span><span class="p">)</span>
            
        <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">data_x</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">data_y</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">))</span>  
        <span class="n">nmin1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">nmin1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sigma_xy</span> <span class="o">/=</span> <span class="n">nmin1</span>
        <span class="n">x</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sigma_xy</span>
        <span class="n">y</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sigma_xy</span>

        <span class="n">factor</span> <span class="o">=</span> <span class="n">sigma_xy</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">/=</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span>
        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">/=</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span>
              
        <span class="n">x</span><span class="o">.</span><span class="n">correlation</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">factor</span>
        <span class="n">y</span><span class="o">.</span><span class="n">correlation</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">factor</span>

    <span class="k">def</span> <span class="nf">set_correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Manually set the correlation between two quantities</span>

<span class="sd">        Given a correlation factor, the covariance and correlation</span>
<span class="sd">        between two variables is added to both objects.</span>

<span class="sd">        :param y: The variable to set the correlation with respect to.</span>
<span class="sd">        :type y: str</span>
<span class="sd">        :param factor: The correlation term between the two variables.</span>
<span class="sd">                       Must be between -1 and 1 inclusive.</span>
<span class="sd">        :type factor: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">factor</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">factor</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Correlation factor must be between -1 and 1.&#39;</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">rho_xy</span> <span class="o">=</span> <span class="n">factor</span>
        <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">rho_xy</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="o">*</span><span class="n">y</span><span class="o">.</span><span class="n">std</span>

        <span class="n">x</span><span class="o">.</span><span class="n">correlation</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">factor</span>
        <span class="n">y</span><span class="o">.</span><span class="n">correlation</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">factor</span>

        <span class="n">x</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sigma_xy</span>
        <span class="n">y</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sigma_xy</span>

    <span class="k">def</span> <span class="nf">set_covariance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sigma_xy</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Manually set the covariance between two quantities</span>

<span class="sd">        Given a covariance value, the covariance and correlation</span>
<span class="sd">        between two variables is added to both objects.</span>

<span class="sd">        :param y: The variable to set the covariance with respect to.</span>
<span class="sd">        :type y: Measurement</span>
<span class="sd">        :param sigma_xy: The covariance term between the two variables.</span>
<span class="sd">        :type sigma_xy: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">sigma_xy</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">/=</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span>
        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">/=</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span>

        <span class="n">x</span><span class="o">.</span><span class="n">correlation</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">factor</span>
        <span class="n">y</span><span class="o">.</span><span class="n">correlation</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">factor</span>

        <span class="n">x</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sigma_xy</span>
        <span class="n">y</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sigma_xy</span>

    <span class="k">def</span> <span class="nf">get_covariance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns the covariance of the object and a specified variable.</span>

<span class="sd">        This funciton checks for the existance of a data array in each</span>
<span class="sd">        object and that the covariance of the two objects is not already</span>
<span class="sd">        specified. In each case, the covariance is returned, unless</span>
<span class="sd">        the data arrays are of different lengths or do not exist, in that</span>
<span class="sd">        case a covariance of zero is returned.</span>

<span class="sd">        :param variable: The variable to get the covariance with respect to.</span>
<span class="sd">        :type variable: Measurement</span>

<span class="sd">        :returns: The covariance term between the two variables.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Constant</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">variable</span><span class="o">.</span><span class="n">covariance</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">variable</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Data&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> \
                <span class="ow">and</span> <span class="n">variable</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Data&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>\
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">_find_covariance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">)</span>
            <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">variable</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">var</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Function</span><span class="p">):</span>
            <span class="n">term</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
                <span class="n">root_obj</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">register</span><span class="p">[</span><span class="n">root</span><span class="p">]</span>
                <span class="n">partial_der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">[</span><span class="n">root</span><span class="p">]</span>
                <span class="n">term</span> <span class="o">+=</span> <span class="n">partial_der</span><span class="o">*</span><span class="n">variable</span><span class="o">.</span><span class="n">get_covariance</span><span class="p">(</span><span class="n">root_obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">term</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_covariance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">term</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">Function</span><span class="p">):</span>
            <span class="n">term</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">variable</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
                <span class="n">root_obj</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">register</span><span class="p">[</span><span class="n">root</span><span class="p">]</span>
                <span class="n">partial_der</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">derivative</span><span class="p">[</span><span class="n">root</span><span class="p">]</span>
                <span class="n">term</span> <span class="o">+=</span> <span class="n">partial_der</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">get_covariance</span><span class="p">(</span><span class="n">root_obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">term</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_covariance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">term</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_get_correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns the correlation factor of two measurements.</span>

<span class="sd">        Using the covariance, or finding the covariance if not defined,</span>
<span class="sd">        the correlation factor of two measurements is returned.</span>

<span class="sd">        :param y: The variable to get the covariance with respect to.</span>
<span class="sd">        :type y: Measurement</span>

<span class="sd">        :returns: The correlation term between the two variables.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Constant</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">covariance</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># ExperimentalValue._find_covariance(x, y)</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="n">sigma_xy</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]]</span>
        <span class="n">sigma_x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span>
        <span class="n">sigma_y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span>
        
        <span class="n">factor</span> <span class="o">=</span> <span class="n">sigma_xy</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">/=</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span>
        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">/=</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span>
            
        <span class="k">return</span> <span class="n">factor</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Methods for Naming and Units</span>
<span class="c1">###############################################################################</span>

    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Used to rename an object or change its units.</span>

<span class="sd">        :param name: The new name of the Measurement.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param units: The new units of the Measurement.</span>
<span class="sd">        :type units: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>

    <span class="k">def</span> <span class="nf">_update_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Update the formula, name and method of an object.</span>

<span class="sd">        Function to update the name, formula and method of a value created</span>
<span class="sd">        by a measurement operation. The name is updated by combining the</span>
<span class="sd">        names of the object acted on with another name using whatever</span>
<span class="sd">        operation is being performed. The function flag is to change syntax</span>
<span class="sd">        for functions like sine and cosine. Method is updated by acessing</span>
<span class="sd">        the class property.</span>

<span class="sd">        :param operation: A mathematical operation on 1 or 2 Measurement objects.</span>
<span class="sd">        :type operation: Function</span>
<span class="sd">        :param *args: The 1 or 2 Measurement objects being operated upon.</span>
<span class="sd">        :type *args: tuple</span>
<span class="sd">        :param func_flag: Whether the operation is a mathematical function.</span>
<span class="sd">            (ie. sqrt, power, sin... are functions but +,-,**... are not).</span>
<span class="sd">        :type func_flag: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">var1</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">var2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">is</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">var1</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">var2</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">op_string</span> <span class="o">=</span> <span class="p">{</span><span class="n">op</span><span class="o">.</span><span class="n">sin</span><span class="p">:</span> <span class="s1">&#39;sin&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">cos</span><span class="p">:</span> <span class="s1">&#39;cos&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">tan</span><span class="p">:</span> <span class="s1">&#39;tan&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">sqrt</span><span class="p">:</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span>
                     <span class="n">op</span><span class="o">.</span><span class="n">csc</span><span class="p">:</span> <span class="s1">&#39;csc&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">sec</span><span class="p">:</span> <span class="s1">&#39;sec&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">cot</span><span class="p">:</span> <span class="s1">&#39;cot&#39;</span><span class="p">,</span>
                     <span class="n">op</span><span class="o">.</span><span class="n">exp</span><span class="p">:</span> <span class="s1">&#39;exp&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span>
                     <span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">:</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">div</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">power</span><span class="p">:</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;neg&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">asin</span><span class="p">:</span> <span class="s1">&#39;asin&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">acos</span><span class="p">:</span> <span class="s1">&#39;acos&#39;</span><span class="p">,</span>
                     <span class="n">op</span><span class="o">.</span><span class="n">atan</span><span class="p">:</span> <span class="s1">&#39;atan&#39;</span><span class="p">,</span> <span class="p">}</span>

        <span class="k">if</span> <span class="n">func_flag</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">var2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">var1</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="n">op_string</span><span class="p">[</span><span class="n">operation</span><span class="p">]</span><span class="o">+</span><span class="n">var2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Formula&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">var1</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Formula&#39;</span><span class="p">]</span> <span class="o">+</span> \
                <span class="n">op_string</span><span class="p">[</span><span class="n">operation</span><span class="p">]</span> <span class="o">+</span> <span class="n">var2</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Formula&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Function&#39;</span><span class="p">][</span><span class="s1">&#39;variables&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Function&#39;</span><span class="p">][</span><span class="s1">&#39;operation&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">operation</span><span class="p">,</span>
            <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">formula_register</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Formula&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Method&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;Errors propagated by &quot;</span> <span class="o">+</span>\
                <span class="bp">self</span><span class="o">.</span><span class="n">error_method</span> <span class="o">+</span> <span class="s1">&#39; method.</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">var1</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">root</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">+=</span> <span class="n">var1</span><span class="o">.</span><span class="n">root</span>
            <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">var2</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">root</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">+=</span> <span class="n">var2</span><span class="o">.</span><span class="n">root</span>

            <span class="k">if</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">var2</span><span class="o">.</span><span class="n">units</span> <span class="ow">and</span> <span class="n">op_string</span><span class="p">[</span><span class="n">operation</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span>

            <span class="k">elif</span> <span class="n">op_string</span><span class="p">[</span><span class="n">operation</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var2</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+</span> <span class="n">var2</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">var2</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

            <span class="k">elif</span> <span class="n">op_string</span><span class="p">[</span><span class="n">operation</span><span class="p">]</span> <span class="ow">is</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var2</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">var1</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">var2</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">var2</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">func_flag</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">var2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">op_string</span><span class="p">[</span><span class="n">operation</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="n">var1</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Formula&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">op_string</span><span class="p">[</span><span class="n">operation</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> \
                <span class="n">var1</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Formula&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Function&#39;</span><span class="p">][</span><span class="s1">&#39;variables&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">var1</span><span class="p">,),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Function&#39;</span><span class="p">][</span><span class="s1">&#39;operation&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">operation</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Method&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;Errors propagated by &quot;</span> <span class="o">+</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">error_method</span> <span class="o">+</span> <span class="s1">&#39; method.</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">formula_register</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Formula&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]})</span>
            <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">var1</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">root</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">+=</span> <span class="n">var1</span><span class="o">.</span><span class="n">root</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#TODO double check with Connor, but I think it was a bug above and we have to check == True</span>
            <span class="c1"># not is True, since 1 could also be True...</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Something went wrong in update_info&#39;</span><span class="p">)</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Operations on measurement objects</span>
<span class="c1">###############################################################################</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># ARITHMETIC OPERATIONS</span>
    <span class="c1"># Called whenever an operation (+, -, /, *, **) is encountered</span>
    <span class="c1"># Call operation_wrap() in error_operations.py</span>
    <span class="c1">###########################################################################</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles addition with Measurements.</span>

<span class="sd">        Ensures that the two objects can be added and then sends them to </span>
<span class="sd">        error_operations.operation_wrap, which handles the addition and</span>
<span class="sd">        error propagation. Called with: Measurement+other </span>

<span class="sd">        :param other: The object to be added.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The sum with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">#TODO: is this the correct implementation??? or should ARRAy create an ndarray???</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1">#result.append(op.operation_wrap(op.add, self, value))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">+</span><span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles addition with Measurements.</span>

<span class="sd">        Ensures that the two objects can be added and then sends them to </span>
<span class="sd">        error_operations.operation_wrap, which handles the addition and</span>
<span class="sd">        error propagation. Called with: other+Measurement</span>

<span class="sd">        :param other: The object to be added.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The sum with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1">#result.append(op.operation_wrap(op.add, self, value))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">+</span><span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles multiplication with Measurements.</span>

<span class="sd">        Ensures that the two objects can be multiplied and then sends them to </span>
<span class="sd">        error_operations.operation_wrap, which handles the multiplication and</span>
<span class="sd">        error propagation. Called with: Measurement*other</span>

<span class="sd">        :param other: The object to be multiplied.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The product with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1">#result.append(op.operation_wrap(op.mul, self, value))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">*</span><span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles multiplication with Measurements.</span>

<span class="sd">        Ensures that the two objects can be multiplied and then sends them to </span>
<span class="sd">        error_operations.operation_wrap, which handles the multiplication and</span>
<span class="sd">        error propagation. Called with: other*Measurement</span>

<span class="sd">        :param other: The object to be multiplied.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The product with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1">#result.append(op.operation_wrap(op.mul, self, value))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">*</span><span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles subtraction with Measurements.</span>

<span class="sd">        Ensures that the object can be subtracted and then sends them to </span>
<span class="sd">        error_operations.operation_wrap, which handles the subtraction and</span>
<span class="sd">        error propagation. Called with: Measurement-other</span>

<span class="sd">        :param other: The object to be subtracted.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The difference with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1">#result.append(op.operation_wrap(op.sub, self, value))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">-</span><span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles subtraction with Measurements.</span>

<span class="sd">        Ensures that the object can be subtracted and then sends them to </span>
<span class="sd">        error_operations.operation_wrap, which handles the subtraction and</span>
<span class="sd">        error propagation. Called with: other-Measurement</span>

<span class="sd">        :param other: The object that the Measurement will be subtracted from.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The difference with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>
                <span class="c1">#result.append(op.operation_wrap(op.sub, value, self))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">-</span><span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles division with Measurements.</span>

<span class="sd">        Ensures that the object can be divided by and then sends them to </span>
<span class="sd">        error_operations.operation_wrap, which handles the division and</span>
<span class="sd">        error propagation. Called with: Measurement/other</span>

<span class="sd">        :param other: The object that the Measurement will be divided by.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The quotient with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">div</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1">#result.append(op.operation_wrap(op.div, self, value))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">/</span><span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">div</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles division with Measurements.</span>

<span class="sd">        Ensures that the object can be divided by and then sends them to </span>
<span class="sd">        error_operations.operation_wrap, which handles the division and</span>
<span class="sd">        error propagation. Called with: other/Measurement</span>

<span class="sd">        :param other: The object that the Measurement will divide.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The quotient with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">div</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1">#result.append(op.operation_wrap(op.div, value, self))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">/</span><span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">div</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles exponentiation with Measurements.</span>

<span class="sd">        Ensures that the object can be raised to the power of the other</span>
<span class="sd">        and then sends them to error_operations.operation_wrap, which</span>
<span class="sd">        handles the exponentiation and error propagation. </span>
<span class="sd">        Called with: Measurement**other</span>

<span class="sd">        :param other: The power that the Measurement will be raised to.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The result with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1">#result.append(op.operation_wrap(op.power, self, value))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">**</span><span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Handles exponentiation with Measurements.</span>

<span class="sd">        Ensures that the object can be raised to the power of the other</span>
<span class="sd">        and then sends them to error_operations.operation_wrap, which</span>
<span class="sd">        handles the exponentiation and error propagation.</span>
<span class="sd">        Called with: other**Measurement</span>

<span class="sd">        :param other: The object that will be raised to the power of the</span>
<span class="sd">            value of the Measurement.</span>
<span class="sd">        :type other: Measurement, constant, array</span>

<span class="sd">        :returns: The result with propagated mean and error.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1">#result.append(op.operation_wrap(op.power, value, self))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span> <span class="ow">and</span>\
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">**</span><span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Calls neg() in error_operations, which returns the negative of the value</span>
    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns the negative of a Measurement object.</span>

<span class="sd">        :returns: The negative of the Measurement.</span>
<span class="sd">        :rtype: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">neg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Returns the length of the ExperimentalValue</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns the length of a the array used to create the Measurement object.</span>

<span class="sd">        :returns: The length of the data array used to create the Measurement.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># COMPARISON OPERATIONS</span>
    <span class="c1"># Called whenever a comparison (&gt;, &lt;, &gt;=, ==, ...) is made</span>
    <span class="c1"># Makes the relevant comparison and return a boolean</span>
    <span class="c1">###########################################################################</span>
    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if two Measurements are the same.</span>

<span class="sd">        :returns: True if the means of the two Measurements are the same,</span>
<span class="sd">                  False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">==</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span>

    <span class="k">def</span> <span class="nf">__req__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if two Measurements are the same.</span>

<span class="sd">        :returns: True if the means of the two Measurements are the same,</span>
<span class="sd">                  False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">==</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span>
            
    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if a Measurement is greater than another Measurement.</span>

<span class="sd">        :returns: True if the mean of the Measurement is greater than the mean</span>
<span class="sd">                  of the other Measurement, False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&gt;</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span>
            
    <span class="k">def</span> <span class="nf">__rgt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if a Measurement is less than another Measurement.</span>

<span class="sd">        :returns: True if the mean of the Measurement is less than the mean</span>
<span class="sd">                  of the other Measurement, False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&lt;</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span> 
            
    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if a Measurement is greater than or equal to another Measurement.</span>

<span class="sd">        :returns: True if the mean of the Measurement is greater than or equal to</span>
<span class="sd">                  the mean of the other Measurement, False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&gt;=</span><span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span>
            
    <span class="k">def</span> <span class="nf">__rge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if a Measurement is less than or equal to another Measurement.</span>

<span class="sd">        :returns: True if the mean of the Measurement is less than or equal to</span>
<span class="sd">                  the mean of the other Measurement, False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&lt;=</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span>
            
    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if a Measurement is less than another Measurement.</span>

<span class="sd">        :returns: True if the mean of the Measurement is less than the mean</span>
<span class="sd">                  of the other Measurement, False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&lt;</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span>
            
    <span class="k">def</span> <span class="nf">__rlt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if a Measurement is greater than another Measurement.</span>

<span class="sd">        :returns: True if the mean of the Measurement is greater than the mean</span>
<span class="sd">                  of the other Measurement, False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&gt;</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span>
            
    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if a Measurement is less than or equal to another Measurement.</span>

<span class="sd">        :returns: True if the mean of the Measurement is less than or equal to</span>
<span class="sd">                  the mean of the other Measurement, False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&lt;=</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span>
            
    <span class="k">def</span> <span class="nf">__rle__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Checks if a Measurement is greater than or equal to another Measurement.</span>

<span class="sd">        :returns: True if the mean of the Measurement is greater than or equal to</span>
<span class="sd">                  the mean of the other Measurement, False otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&gt;=</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span><span class="o">.</span><span class="n">type</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span>

    <span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">e</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">csc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">csc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sec</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sec</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cot</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">asin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">asin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">acos</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">acos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">atan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">atan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Miscellaneous Methods</span>
<span class="c1">###############################################################################</span>

    <span class="k">def</span> <span class="nf">_check_der</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Checks for a derivative with respect to b, else zero is defined as</span>
<span class="sd">        the derivative.</span>

<span class="sd">        Checks the existance of the derivative of an object in the</span>
<span class="sd">        dictionary of said object with respect to another variable, given</span>
<span class="sd">        the variable itself, then checking for the ID of said variable</span>
<span class="sd">        in the .derivative dictionary. If non exists, the deriviative is</span>
<span class="sd">        assumed to be zero.</span>

<span class="sd">        :param b: The variable to check the derivative with respect to.</span>
<span class="sd">        :type b: Measurement</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">derivative</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>


<span class="c1">###############################################################################</span>
<span class="c1"># Measurement Sub-Classes</span>
<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="Measurement"><a class="viewcode-back" href="../../measurement.html#qexpy.error.Measurement">[docs]</a><span class="k">class</span> <span class="nc">Measurement</span><span class="p">(</span><span class="n">ExperimentalValue</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Subclass of ExperimentalValue, specified by the user and treated as variables</span>
<span class="sd">    or arguments of functions when propagating error. Stores the mean and</span>
<span class="sd">    standard deviation of an experimentally measured value.</span>

<span class="sd">    :param name: The name of the Measurement object.</span>
<span class="sd">    :type name: str</span>
<span class="sd">    :param units: The units of the Measurement.</span>
<span class="sd">    :type units: str</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">id_number</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;unnamed_var</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Measurement</span><span class="o">.</span><span class="n">id_number</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">_parse_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;ExperimentalValue&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;var</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Measurement</span><span class="o">.</span><span class="n">id_number</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Formula&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;var</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Measurement</span><span class="o">.</span><span class="n">id_number</span><span class="p">)</span>
        <span class="n">Measurement</span><span class="o">.</span><span class="n">id_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="o">**</span><span class="mi">2</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">],)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">der</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MC</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MinMax</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">]</span></div>

<span class="k">class</span> <span class="nc">Function</span><span class="p">(</span><span class="n">ExperimentalValue</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Subclass of ExperimentalValue, which are measurements created by operations or</span>
<span class="sd">    functions of other Measurement type objects. They contain the mean and propagated</span>
<span class="sd">    error of the function.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">id_number</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;obj</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Function</span><span class="o">.</span><span class="n">id_number</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;obj</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Function</span><span class="o">.</span><span class="n">id_number</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;Function&quot;</span>
        <span class="n">Function</span><span class="o">.</span><span class="n">id_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="o">**</span><span class="mi">2</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">der</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">#These are set by super()</span>
        <span class="c1">#self.MC = None</span>
        <span class="c1">#self.MinMax = None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_flag</span> <span class="o">=</span> <span class="kc">False</span>


<span class="k">class</span> <span class="nc">Constant</span><span class="p">(</span><span class="n">ExperimentalValue</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Subclass of ExperimentalValue, not neccesarily specified by the user,</span>
<span class="sd">    called when a consant (int, float, etc.) is used in operation with a</span>
<span class="sd">    measurement. This class is called before calculating operations to</span>
<span class="sd">    ensure objects can be combined. The mean of a constant is the specified</span>
<span class="sd">    value, the standard deviation is zero, and the derivarive with respect</span>
<span class="sd">    to anything is zero.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">units</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Constant&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Formula&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">arg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;Data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">arg</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;Constant&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="p">()</span>


<div class="viewcode-block" id="Measurement_Array"><a class="viewcode-back" href="../../measurement_arr.html#qexpy.error.Measurement_Array">[docs]</a><span class="k">class</span> <span class="nc">Measurement_Array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;A numpy-based array of Measurement objects. It is better to call</span>
<span class="sd">       MeasurementArray() and let it create a Measurement_Array object</span>
<span class="sd">       behind the scenes.&#39;&#39;&#39;</span>
    <span class="n">id_number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">error_method</span> <span class="o">=</span> <span class="s2">&quot;Derivative&quot;</span>
    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Measurement</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
          <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">error_method</span><span class="o">=</span><span class="s1">&#39;Derivative&#39;</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span>
                         <span class="n">order</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;unnamed_arr</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Measurement_Array</span><span class="o">.</span><span class="n">id_number</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">error_method</span> <span class="o">=</span> <span class="n">error_method</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">_parse_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">Measurement_Array</span><span class="o">.</span><span class="n">id_number</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">__array_finalize__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the name and units of the MeasurementArray during creation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__array_wrap__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_arr</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Used to make sure that numpy functions work on MeasurementArrays</span>
<span class="sd">        and they return MeasurementArrays.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># then just call the parent</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">__array_wrap__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_arr</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

<div class="viewcode-block" id="Measurement_Array.append"><a class="viewcode-back" href="../../measurement_arr.html#qexpy.error.Measurement_Array.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meas</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Appends a value to the end of a MeasurementArray.</span>

<span class="sd">        :param meas: A measurement to be appended to the MeasurementArray.</span>
<span class="sd">        :type meas: Measurement, constant</span>

<span class="sd">        :returns: A MeasurementArray with the new value added to the end.</span>
<span class="sd">        :rtype: Measurement_Array</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">meas</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="n">meas</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">meas</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">meas</span><span class="p">,</span> <span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">meas</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>
            <span class="n">meas</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__array_wrap__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meas</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object to append must be a Measurement or a number&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Measurement_Array.insert"><a class="viewcode-back" href="../../measurement_arr.html#qexpy.error.Measurement_Array.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">meas</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Inserts a value in a position in a MeasurementArray.</span>

<span class="sd">        :param pos: The 0-indexed position in the MeasurementArray that the</span>
<span class="sd">            measurement will be inserted into. Must be between 0 and the</span>
<span class="sd">            length of the MeasurementArray.</span>
<span class="sd">        :type pos: int</span>
<span class="sd">        :param meas: A measurement to be inserted into the MeasurementArray.</span>
<span class="sd">        :type meas: Measurement, constant</span>

<span class="sd">        :returns: A MeasurementArray with the new value inserted into the position</span>
<span class="sd">                  specified by the pos parameter.</span>
<span class="sd">        :rtype: Measurement_Array</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Index for inserting out of bounds.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">meas</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
            <span class="n">meas</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">meas</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">meas</span><span class="p">,</span> <span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">meas</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>
            <span class="n">meas</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">meas</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">index</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__array_wrap__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object to insert must be a Measurement or a number&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Measurement_Array.delete"><a class="viewcode-back" href="../../measurement_arr.html#qexpy.error.Measurement_Array.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Removes an element from a MeasurementArray.</span>

<span class="sd">        :param pos: The 0-indexed position in the MeasurementArray of the</span>
<span class="sd">            Measurement that will be deleted. Must be between 0 and the</span>
<span class="sd">            length of the MeasurementArray.</span>
<span class="sd">        :type pos: int</span>

<span class="sd">        :returns: A MeasurementArray with the Measurement at the specified position</span>
<span class="sd">                  removed.</span>
<span class="sd">        :rtype: Measurement_Array</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Index for deleting out of bounds.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)):</span>
            <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__array_wrap__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">means</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a numpy array with the means of each value in the MeasurementArray,</span>
<span class="sd">        as calculated by the method (der, MC, MinMax).</span>

<span class="sd">        :getter: Returns a numpy array of the means of the Measurements</span>
<span class="sd">                 in the MeasurementArray.</span>
<span class="sd">        :type: numpy.ndarray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_method</span> <span class="o">==</span> <span class="s2">&quot;MinMax&quot;</span><span class="p">:</span>
                    <span class="n">means</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">MinMax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_method</span> <span class="o">==</span> <span class="s2">&quot;MC&quot;</span><span class="p">:</span>
                    <span class="n">means</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">MC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">means</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">mean</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">means</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">means</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a numpy array with the standard deviations of each value</span>
<span class="sd">        in the MeasurementArray, as calculated by the method (der, MC, MinMax).</span>

<span class="sd">        :setter: Sets the errors of the Measurement_Array to either a single</span>
<span class="sd">                 value if a number is provided, or to  different errors if a</span>
<span class="sd">                 list is provided.</span>
<span class="sd">        :getter: Returns a numpy array of the standard deviations of </span>
<span class="sd">                 the Measurements in the MeasurementArray.</span>
<span class="sd">        :type: numpy.ndarray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">stds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>              
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_method</span> <span class="o">==</span> <span class="s2">&quot;MinMax&quot;</span><span class="p">:</span>
                    <span class="n">stds</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_method</span> <span class="o">==</span> <span class="s2">&quot;MC&quot;</span><span class="p">:</span>
                    <span class="n">stds</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">MC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stds</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">std</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stds</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">stds</span>

    <span class="nd">@stds</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">stds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the standard deviations of each value in the MeasurementArray,</span>
<span class="sd">        either to the same value for all Measurements or to a different value</span>
<span class="sd">        for each Measurement.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span><span class="p">):</span><span class="c1">#MA([,,,,], error = x)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="o">=</span><span class="n">error</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span><span class="p">):</span><span class="c1">#MA([,,,,], error = [])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">==</span><span class="n">n</span><span class="p">:</span><span class="c1">#MA([,,,,], error = [,,,,])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="o">=</span><span class="n">error</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="c1">#MA([,,,,], error = [x])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="o">=</span><span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error list must be the same length as the original list&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Gets the mean of the means of the Measurements in the MeasurementArray.</span>

<span class="sd">        :getter: Returns the mean of the means of all the Measurements in the</span>
<span class="sd">                 MeasurementArray.</span>
<span class="sd">        :type: numpy.ndarray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">nparr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mean</span> <span class="o">=</span> <span class="n">nparr</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mean</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">error_weighted_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Gets the error weighted mean and error of a MeasurementArray.</span>
<span class="sd">        The error weighted mean gives more weight to more precise Measurements.</span>

<span class="sd">        :getter: Returns the weighted mean of all the Measurements in the</span>
<span class="sd">                 MeasurementArray.</span>
<span class="sd">        :type: tuple</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">means</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
        <span class="n">stds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stds</span>
        <span class="n">stds2</span> <span class="o">=</span> <span class="n">stds</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">sumw2</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">mean</span><span class="o">=</span><span class="mi">0</span>

        <span class="c1">#Needs to be a loop to catch the case of std == 0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">means</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">stds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">w2</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">stds2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">mean</span> <span class="o">+=</span> <span class="n">w2</span><span class="o">*</span><span class="n">means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">sumw2</span> <span class="o">+=</span> <span class="n">w2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_error_weighted_mean</span> <span class="o">=</span>  <span class="p">(</span><span class="mf">0.</span> <span class="k">if</span> <span class="n">sumw2</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">mean</span><span class="o">/</span><span class="n">sumw2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_weighted_std</span> <span class="o">=</span>  <span class="p">(</span><span class="mf">0.</span> <span class="k">if</span> <span class="n">sumw2</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">sumw2</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">Measurement</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_error_weighted_mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_weighted_std</span><span class="p">)</span>
    
<div class="viewcode-block" id="Measurement_Array.std"><a class="viewcode-back" href="../../measurement_arr.html#qexpy.error.Measurement_Array.std">[docs]</a>    <span class="k">def</span> <span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Calculates the standard deviation of the means of </span>
<span class="sd">        all the Measurements in the MeasurementArray.</span>

<span class="sd">        :param ddof: The degrees of freedom of the MeasurementArray.</span>
<span class="sd">        :type ddof: int</span>

<span class="sd">        :returns: The standard deviation of the means of all the </span>
<span class="sd">                  Measurements in the MeasurementArray. </span>
<span class="sd">        :rtype: numpy.ndarray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">nparr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
        <span class="k">return</span> <span class="n">nparr</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;The units of a Measurement_Array.</span>

<span class="sd">        :setter: Sets the units of the Measurement object.</span>
<span class="sd">        :getter: Returns the name of the Measurement object.</span>
<span class="sd">        :type: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span>

    <span class="nd">@units</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the units of a Measurement_Array.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">mes</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">mes</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="n">_parse_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="n">units</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
                        <span class="n">mes</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
             
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">units</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="p">[</span><span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    
<div class="viewcode-block" id="Measurement_Array.get_units_str"><a class="viewcode-back" href="../../measurement_arr.html#qexpy.error.Measurement_Array.get_units_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_units_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Generates a string representation of the units.</span>

<span class="sd">        :returns: A string representation of the units of the MeasurementArray.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">unit_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">!=</span> <span class="p">{}:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">unit_string</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="n">unit_string</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">unit_string</span> <span class="o">+=</span> <span class="n">key</span><span class="o">+</span><span class="s1">&#39;^</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                    <span class="n">unit_string</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>

                <span class="k">if</span> <span class="n">unit_string</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">unit_string</span> <span class="o">=</span> <span class="s1">&#39;unitless&#39;</span>
        <span class="k">return</span> <span class="n">unit_string</span>        </div>
    
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a string representation of the MeasurementArray.</span>

<span class="sd">        :returns: A representation of the MeasurementArray.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">theString</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="n">theString</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">__str__</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">theString</span> <span class="o">+=</span> <span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">theString</span></div>
            
<div class="viewcode-block" id="MeasurementArray"><a class="viewcode-back" href="../../measurement_arr.html#qexpy.error.MeasurementArray">[docs]</a><span class="k">def</span> <span class="nf">MeasurementArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error_method</span><span class="o">=</span><span class="s1">&#39;Derivative&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Function to easily construct a Measurement_Array object. It is better to call this</span>
<span class="sd">    function and let it create the Measurement_Array object behind the scenes.</span>

<span class="sd">    :param error: Either a single value representing the error on all</span>
<span class="sd">        the Measurements in the MeasurementArray, or a list of errors </span>
<span class="sd">        corresponding to all the Measurements in the MeasurementArray.</span>
<span class="sd">    :type error: constant, array</span>
<span class="sd">    :param name: A string of the name of the MeasurementArray.</span>
<span class="sd">    :type name: str</span>
<span class="sd">    :param units: A string of the units of the MeasurementArray.</span>
<span class="sd">    :type units: str</span>
<span class="sd">    :param error_method: Which method to use when propagating errors through</span>
<span class="sd">                         calculations on the MeasurementArray. </span>
<span class="sd">                         Can be &#39;Monte Carlo&#39;, &#39;Min Max&#39; or&#39;Derivative&#39;</span>
<span class="sd">    :type error_method: str</span>

<span class="sd">    :returns: A Measurement_Array object.</span>
<span class="sd">    :rtype: Measurement_Array</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">array</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">error_method</span><span class="o">=</span><span class="n">error_method</span><span class="p">)</span>
    <span class="n">user_name</span><span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>
        
    <span class="k">if</span> <span class="n">error</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1">#MA(data)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Measurement_Array</span><span class="p">):</span><span class="c1"># MA(MA)</span>
            <span class="c1">#TODO should this be a copy?? This will just </span>
            <span class="c1">#make array be a reference to data...</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">array</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
            <span class="c1">#allow the name to be updated:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">array</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>  
                
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span><span class="p">):</span> <span class="c1">#MA([...])</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>       
            <span class="n">array</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="c1">#MA([ (,), (,), (,)])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Measurement</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>
                    <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">user_name</span><span class="o">=</span><span class="n">user_name</span>
                    
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span><span class="p">):</span> <span class="c1">#MA([,,,])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Measurement</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>
                    <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">user_name</span><span class="o">=</span><span class="n">user_name</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ExperimentalValue</span><span class="p">):</span> <span class="c1">#MA([Measurement,Measurement,Measurement,])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
                    <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">user_name</span><span class="o">=</span><span class="n">user_name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unsupported type for data&quot;</span><span class="p">)</span>
             
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">int_types</span><span class="p">):</span> <span class="c1">#MA(n)</span>
            <span class="n">array</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Measurement</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>
                <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">user_name</span><span class="o">=</span><span class="n">user_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unsupported type for data&quot;</span><span class="p">)</span>
            
    <span class="k">else</span><span class="p">:</span> <span class="c1">#error is not None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Measurement_Array</span><span class="p">):</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">array</span><span class="o">.</span><span class="n">stds</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">array</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
            <span class="c1">#allow the name to be updated:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">array</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

            
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span><span class="p">):</span> <span class="c1">#MA([], error = ...)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>       
            <span class="n">array</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span><span class="p">):</span><span class="c1">#MA([,,,,], error = ...)</span>
                
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span><span class="p">):</span><span class="c1">#MA([,,,,], error = x)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                        <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                        <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Measurement</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">error</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>
                        <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">user_name</span><span class="o">=</span><span class="n">user_name</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span><span class="p">):</span><span class="c1">#MA([,,,,], error = [])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span><span class="c1">#MA([,,,,], error = [,,,,])</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                            <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                            <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Measurement</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">error</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>    
                            <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">user_name</span><span class="o">=</span><span class="n">user_name</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="c1">#MA([,,,,], error = [x])</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                            <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                            <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Measurement</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>
                            <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">user_name</span><span class="o">=</span><span class="n">user_name</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error array must be same length as data&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unsupported type for error&quot;</span><span class="p">)</span>
                    
            <span class="k">else</span><span class="p">:</span> <span class="c1"># data[0] must be a float</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unsupported type for data:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span><span class="p">):</span> <span class="c1">#MA(x,error=...)</span>
            <span class="n">array</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">number_types</span><span class="p">):</span><span class="c1">#MA(x, error = y)</span>
                <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">Measurement</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="n">error</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>
                <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_name</span><span class="o">=</span><span class="n">user_name</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">qu</span><span class="o">.</span><span class="n">array_types</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span><span class="c1">#MA(x, error = [u])</span>
                <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">Measurement</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">data_name</span><span class="p">)</span>
                <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_name</span><span class="o">=</span><span class="n">user_name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unsupported type for error&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unsupported type of data&quot;</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">array</span>        </div>
        
        

<span class="c1">###############################################################################</span>
<span class="c1"># Mathematical Functions</span>
<span class="c1"># These are called for functions in the form: error.func(ExperimentalValue)</span>
<span class="c1"># They call operation_wrap() in the error_operations.py file</span>
<span class="c1">###############################################################################</span>

<span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span> <span class="o">+</span><span class="p">(</span><span class="n">Measurement_Array</span><span class="p">,)</span>

<span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>      
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
        <span class="c1">#result = []      </span>
        <span class="c1">#for value in x:</span>
            <span class="c1">#result.append(op.operation_wrap(op.sin, value, func_flag=True))</span>
        
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
          
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">cos</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">cos</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.cos, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">cos</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">tan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.tan, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">sec</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sec</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sec</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.sec, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sec</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">csc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">csc</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">csc</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.csc, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">csc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">cot</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">cot</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">cot</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.cot, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">cot</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.log, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.exp, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">e</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.exp, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">asin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">asin</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">asin</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.asin, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">asin</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">acos</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">acos</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">acos</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.acos, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">acos</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">atan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">qexpy.error_operations</span> <span class="k">as</span> <span class="nn">op</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">ARRAY</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ExperimentalValue</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Measurement_Array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">atan</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">result</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">atan</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#result = []</span>
        <span class="c1">#for value in x:</span>
        <span class="c1">#    result.append(op.operation_wrap(op.atan, value, func_flag=True))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">operation_wrap</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">atan</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">func_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1"># Printing Methods</span>
<span class="c1">###############################################################################</span>


<span class="k">def</span> <span class="nf">set_print_style</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Change style (&quot;default&quot;,&quot;latex&quot;,&quot;scientific&quot;) of printout for</span>
<span class="sd">    Measurement objects.</span>

<span class="sd">    The default style prints as the user might write a value, that is</span>
<span class="sd">    &#39;x = 10 +/- 1&#39;.</span>

<span class="sd">    Latex style prints in the form of &#39;x = (10\pm 1)\e0&#39; which is ideal for</span>
<span class="sd">    pasting values into a Latex document as will be the case for lab reports.</span>

<span class="sd">    The scientific style prints the value in reduced scientific notation</span>
<span class="sd">    such that the error is a single digit, &#39;x = (10 +/- 1)*10**0&#39;.</span>

<span class="sd">    :param style: The style that the Measurement objects are printed with.</span>
<span class="sd">                  Can be &#39;Latex&#39;, &#39;Scientific&#39; or &#39;Default&#39;.</span>
<span class="sd">    :type style: str</span>
<span class="sd">    :param sigfigs: The number of significant figures to use when printing.</span>
<span class="sd">    :type sigfigs: int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">latex</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Latex&quot;</span><span class="p">,</span> <span class="s2">&quot;latex&quot;</span><span class="p">,</span> <span class="s1">&#39;Tex&#39;</span><span class="p">,</span> <span class="s1">&#39;tex&#39;</span><span class="p">,)</span>
    <span class="n">Sci</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Scientific&quot;</span><span class="p">,</span> <span class="s2">&quot;Sci&quot;</span><span class="p">,</span> <span class="s1">&#39;scientific&#39;</span><span class="p">,</span> <span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="s1">&#39;sigfigs&#39;</span><span class="p">,)</span>
    <span class="n">Default</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;Default&#39;</span><span class="p">,)</span>

    <span class="k">if</span> <span class="n">sigfigs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">set_sigfigs</span><span class="p">(</span><span class="n">sigfigs</span><span class="p">)</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs_on_uncertainty</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">latex</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span> <span class="o">=</span> <span class="s2">&quot;Latex&quot;</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">Sci</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span> <span class="o">=</span> <span class="s2">&quot;Scientific&quot;</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">Default</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span> <span class="o">=</span> <span class="s2">&quot;Default&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;A style must be a string of either: Scientific notation,</span>
<span class="s1">        Latex, or the default style. Using default.&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span> <span class="o">=</span> <span class="s2">&quot;Default&quot;</span>


<span class="k">def</span> <span class="nf">set_error_method</span><span class="p">(</span><span class="n">chosen_method</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Choose the method of error propagation to be used. Enter a string.</span>

<span class="sd">    Function to change default error propogation method used in</span>
<span class="sd">    measurement functions.</span>

<span class="sd">    :param chosen_method: The method to be used to propagate errors.</span>
<span class="sd">                          Can be &#39;Monte Carlo&#39;, &#39;Min Max&#39; or &#39;Default&#39;.</span>
<span class="sd">    :type chosen_method: str</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">mc_list</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">&#39;MC&#39;</span><span class="p">,</span> <span class="s1">&#39;mc&#39;</span><span class="p">,</span> <span class="s1">&#39;montecarlo&#39;</span><span class="p">,</span> <span class="s1">&#39;Monte Carlo&#39;</span><span class="p">,</span> <span class="s1">&#39;MonteCarlo&#39;</span><span class="p">,</span>
        <span class="s1">&#39;monte carlo&#39;</span><span class="p">,)</span>
    <span class="n">min_max_list</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Min Max&#39;</span><span class="p">,</span> <span class="s1">&#39;MinMax&#39;</span><span class="p">,</span> <span class="s1">&#39;minmax&#39;</span><span class="p">,</span> <span class="s1">&#39;min max&#39;</span><span class="p">,)</span>
    <span class="n">derr_list</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Derivative&#39;</span><span class="p">,</span> <span class="s1">&#39;derivative&#39;</span><span class="p">,</span> <span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;der&#39;</span><span class="p">,</span> <span class="s1">&#39;Default&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;default&#39;</span><span class="p">,)</span>

    <span class="k">if</span> <span class="n">chosen_method</span> <span class="ow">in</span> <span class="n">mc_list</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">error_method</span> <span class="o">=</span> <span class="s2">&quot;Monte Carlo&quot;</span>
    <span class="k">elif</span> <span class="n">chosen_method</span> <span class="ow">in</span> <span class="n">min_max_list</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">error_method</span> <span class="o">=</span> <span class="s2">&quot;Min Max&quot;</span>
    <span class="k">elif</span> <span class="n">chosen_method</span> <span class="ow">in</span> <span class="n">derr_list</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">error_method</span> <span class="o">=</span> <span class="s2">&quot;Derivative&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Method not recognized, using derivative method.&quot;</span><span class="p">)</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">error_method</span> <span class="o">=</span> <span class="s2">&quot;Derivative&quot;</span>


<span class="k">def</span> <span class="nf">set_sigfigs_error</span><span class="p">(</span><span class="n">sigfigs</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Change the number of significant figures shown in print()</span>
<span class="sd">    based on the number of sig figs in the error.</span>

<span class="sd">    :param sigfigs: The number of significant figures to use when printing.</span>
<span class="sd">    :type sigfigs: int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sigfigs</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">sigfigs</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">sigfigs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">=</span> <span class="n">sigfigs</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs_on_uncertainty</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Specified number of significant figures must be</span>
<span class="s1">                        and interger greater than zero.&#39;&#39;&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">set_sigfigs_centralvalue</span><span class="p">(</span><span class="n">sigfigs</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Change the number of significant figures shown in print()</span>
<span class="sd">    based on the number of sig figs in the central value.</span>

<span class="sd">    :param sigfigs: The number of significant figures to use when printing.</span>
<span class="sd">    :type sigfigs: int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sigfigs</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">sigfigs</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">sigfigs</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">=</span> <span class="n">sigfigs</span>
        <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs_on_uncertainty</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Specified number of significant figures must be</span>
<span class="s1">                        an interger greater than zero.&#39;&#39;&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">set_sigfigs</span><span class="p">(</span><span class="n">sigfigs</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Change the number of significant figures shown in print()</span>
<span class="sd">    based on the number of sig figs in the error.</span>

<span class="sd">    :param sigfigs: The number of significant figures to use when printing.</span>
<span class="sd">    :type sigfigs: int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">set_sigfigs_error</span><span class="p">(</span><span class="n">sigfigs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_return_exponent</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculates the exponent of the argument in reduced scientific notation.</span>

<span class="sd">    :param value: The value to get the exponent for.</span>
<span class="sd">    :type value: float</span>

<span class="sd">    :returns: The exponent of the order of magnitude of the value.</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">*=</span> <span class="mi">10</span>
            <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">/=</span> <span class="mi">10</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">i</span>


<span class="k">def</span> <span class="nf">_return_print_values</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Function for returning the correct mean and std for the method</span>
<span class="sd">    selected.</span>

<span class="sd">    :param variable: The variable we want to find the mean+/-error for</span>
<span class="sd">    :type variable: Measurement</span>
<span class="sd">    :param method: The method used to propagate error we want to find </span>
<span class="sd">                   the mean and error for.</span>
<span class="sd">    :type method: str</span>

<span class="sd">    :returns: The mean and standard deviation of the variable.</span>
<span class="sd">    :rtype: tuple</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">,)</span>
    <span class="k">if</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">error_method</span> <span class="o">==</span> <span class="s1">&#39;Derivative&#39;</span><span class="p">:</span>
        <span class="p">[</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">der</span>
    <span class="k">elif</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">error_method</span> <span class="o">==</span> <span class="s1">&#39;Monte Carlo&#39;</span><span class="p">:</span>
        <span class="p">[</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">MC</span>
    <span class="k">elif</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">error_method</span> <span class="o">==</span> <span class="s1">&#39;Min Max&#39;</span><span class="p">:</span>
        <span class="p">[</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">MinMax</span>

    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="s1">&#39;Derivative&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">der</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="ow">is</span> <span class="s1">&#39;Monte Carlo&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">MC</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="ow">is</span> <span class="s1">&#39;Min Max&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">MinMax</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,)</span>


<span class="k">def</span> <span class="nf">_tex_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Creates string used by __str__ in a style useful for printing in Latex,</span>
<span class="sd">    as a value with error, in brackets multiplied by a power of ten. (ie.</span>
<span class="sd">    15+/-0.3 is (150 \pm 3)\e-1. Where Latex parses \pm as +\- and \e as</span>
<span class="sd">    *10**-1)</span>

<span class="sd">    :param method: The method used to propagate error we want to find </span>
<span class="sd">                   the mean and error for.</span>
<span class="sd">    :type method: str</span>

<span class="sd">    :returns: The mean+/-error of the variable, formatted using tex style.</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">_return_print_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>\
            <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs_on_uncertainty</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">mean</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;inf&quot;</span>

        <span class="n">figs</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_return_exponent</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">figs</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">std</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">figs</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">-</span> <span class="n">figs</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> \pm </span><span class="si">%d</span><span class="s2">)*10^{</span><span class="si">%d</span><span class="s2">}&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">figs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> \pm </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>\
            <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs_on_uncertainty</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">mean</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;inf&quot;</span>

        <span class="n">figs</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_return_exponent</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">figs</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">std</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">figs</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">-</span> <span class="n">figs</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> \pm </span><span class="si">%d</span><span class="s2">)*10^{</span><span class="si">%d</span><span class="s2">}&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">figs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> \pm </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_return_exponent</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">std</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> \pm </span><span class="si">%d</span><span class="s2">)*10^{</span><span class="si">%d</span><span class="s2">}&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> \pm </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_def_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns string used by __str__ as two numbers representing mean and error</span>
<span class="sd">    to either the first non-zero digit of error or to a specified number of</span>
<span class="sd">    significant figures.</span>

<span class="sd">    :param method: The method used to propagate error we want to find </span>
<span class="sd">                   the mean and error for.</span>
<span class="sd">    :type method: str</span>

<span class="sd">    :returns: The mean+/-error of the variable, formatted using the default style.</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_method</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">method</span> <span class="k">else</span> <span class="n">method</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">_return_print_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>\
            <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs_on_uncertainty</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">mean</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;inf&quot;</span>

        <span class="n">figs</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_return_exponent</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>

        <span class="n">decimal_places</span> <span class="o">=</span> <span class="n">figs</span> <span class="o">-</span> <span class="n">i</span>
        <span class="k">if</span> <span class="n">decimal_places</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">decimal_places</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s2">&quot;%.&quot;</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="s2">&quot;f&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.0f</span><span class="s1">&#39;</span>
        <span class="n">std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="n">decimal_places</span><span class="p">))</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">decimal_places</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; +/- &quot;</span><span class="o">+</span><span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">std</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>\
            <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs_on_uncertainty</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">mean</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;inf&quot;</span>

        <span class="n">figs</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_return_exponent</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

        <span class="n">decimal_places</span> <span class="o">=</span> <span class="n">figs</span> <span class="o">-</span> <span class="n">i</span>
        <span class="k">if</span> <span class="n">decimal_places</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">decimal_places</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s2">&quot;%.&quot;</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="s2">&quot;f&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.0f</span><span class="s1">&#39;</span>
        <span class="n">std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="n">decimal_places</span><span class="p">))</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">decimal_places</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; +/- &quot;</span><span class="o">+</span><span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">std</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mean</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">std</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;inf +/- inf&quot;</span>
        
        <span class="k">if</span> <span class="n">mean</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;inf&quot;</span>

        <span class="k">if</span> <span class="n">std</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; +/- &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="n">_return_exponent</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s2">&quot;%.&quot;</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="s2">&quot;f&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.0f</span><span class="s1">&#39;</span>

        <span class="n">mean</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">std</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span>  <span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; +/- inf&quot;</span>
        
        <span class="n">std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; +/- &quot;</span><span class="o">+</span><span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">std</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_sci_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns string used by __str__ as two numbers representing mean and</span>
<span class="sd">    error, each in scientific notation to a specified numebr of significant</span>
<span class="sd">    figures, or 3 if none is given.</span>

<span class="sd">    :param method: The method used to propagate error we want to find </span>
<span class="sd">                   the mean and error for.</span>
<span class="sd">    :type method: str</span>

<span class="sd">    :returns: The mean+/-error of the variable, formatted using scientific notation.</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">_return_print_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>\
            <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs_on_uncertainty</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">mean</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;inf&quot;</span>

        <span class="n">figs</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_return_exponent</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">figs</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">std</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">figs</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">-</span> <span class="n">figs</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> +/- </span><span class="si">%d</span><span class="s2">)*10^(</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">figs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> +/- </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>\
            <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs_on_uncertainty</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">mean</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;inf&quot;</span>

        <span class="n">figs</span> <span class="o">=</span> <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_return_exponent</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">figs</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">std</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">figs</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">-</span> <span class="n">figs</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> +/- </span><span class="si">%d</span><span class="s2">)*10^(</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">figs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> +/- </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_return_exponent</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">std</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> +/- </span><span class="si">%d</span><span class="s2">)*10^(</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">%d</span><span class="s2"> +/- </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1"># Random Methods</span>
<span class="c1">###############################################################################</span>

<span class="k">def</span> <span class="nf">_parse_units</span><span class="p">(</span><span class="n">unit_str</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Parses the string representation of an objects units and</span>
<span class="sd">    breaks it into it&#39;s constituent parts and their powers.</span>

<span class="sd">    :param unit_str: A string representation of an object&#39;s units.</span>
<span class="sd">    :type unit_str: str</span>

<span class="sd">    :returns: A dictionary with the unit names as keys and their powers as values.</span>
<span class="sd">    :rtype: dict</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">unit_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">div_split</span> <span class="o">=</span> <span class="n">unit_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">div_split</span><span class="p">)):</span>
        <span class="n">mult_split</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[a-zA-Z]+\^[+-]?\d+|[a-zA-Z]+&#39;</span><span class="p">,</span> <span class="n">div_split</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="c1"># regex that finds [string^(+/- number)] or [string]</span>
        <span class="k">for</span> <span class="n">term2</span> <span class="ow">in</span> <span class="n">mult_split</span><span class="p">:</span>
            <span class="n">pow_split</span> <span class="o">=</span> <span class="n">term2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">)</span>
            <span class="n">power_factor</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">index</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">power</span> <span class="o">=</span> <span class="n">power_factor</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">pow_split</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pow_split</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="k">else</span> <span class="n">power_factor</span><span class="o">*</span><span class="mi">1</span>
            <span class="n">unit_dict</span><span class="p">[</span><span class="n">pow_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">power</span>
    <span class="k">return</span> <span class="n">unit_dict</span>

<span class="k">def</span> <span class="nf">show_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;inline&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Creates a histogram of the inputted data using Bokeh or mpl.</span>

<span class="sd">    :param title: The title that will appear at the top of the histogram.</span>
<span class="sd">    :type title: str</span>
<span class="sd">    :param output: How the histogram is to be output. Can be &#39;inline&#39; or &#39;file&#39;.</span>
<span class="sd">    :type output: str</span>

<span class="sd">    :returns: The Plot object used to create the histogram.</span>
<span class="sd">    :rtype: Plot</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ARRAY</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Input histogram data must be an array&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">hist_title</span> <span class="o">=</span> <span class="n">title</span>
    <span class="k">elif</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hist_title</span> <span class="o">=</span> <span class="s1">&#39;Histogram&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Histogram title must be a string.&#39;</span><span class="p">)</span>
        <span class="n">hist_title</span> <span class="o">=</span> <span class="s1">&#39;Histogram&#39;</span>

    <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">_variance</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">xy_data</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">XYDataSet</span><span class="p">(</span><span class="n">xdata</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">is_histogram</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">data_name</span><span class="o">=</span><span class="n">hist_title</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">MakePlot</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_dataset</span><span class="p">(</span><span class="n">xy_data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*.</span><span class="mi">95</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="mf">1.05</span><span class="p">]</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">xy_data</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span><span class="o">*</span><span class="mf">1.2</span><span class="p">]</span>

    <span class="c1"># Draws lines at the mean and location of the mean +/- standard deviation.</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
    <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">dashed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="o">+</span><span class="n">std</span><span class="p">,</span> <span class="n">dashed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="o">-</span><span class="n">std</span><span class="p">,</span> <span class="n">dashed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span>


<span class="k">def</span> <span class="nf">numerical_partial_derivative</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns the parital derivative of a dunction with respect to var.</span>

<span class="sd">    This function wraps the inputted function to become a function</span>
<span class="sd">    of only one variable, the derivative is taken with respect to said</span>
<span class="sd">    variable.</span>

<span class="sd">    :param func: The function to take the derivative of.</span>
<span class="sd">    :type func:</span>
<span class="sd">    :param var: The variable to take the derivative with respect to.</span>
<span class="sd">    :type var: Measurement</span>

<span class="sd">    :returns: The derivative of the function with respect to the specified variable.</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">restrict_dimension</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">partial_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">partial_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">partial_args</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">numerical_derivative</span><span class="p">(</span><span class="n">restrict_dimension</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">numerical_derivative</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculates the first order derivative of a function.</span>

<span class="sd">    :param function: The function to take the derivative of.</span>
<span class="sd">    :type function: Function</span>
<span class="sd">    :param point: The point on the function to take the derivative at.</span>
<span class="sd">    :type point: float</span>

<span class="sd">    :returns: The derivative of the function.</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">point</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span><span class="o">-</span><span class="n">function</span><span class="p">(</span><span class="n">point</span><span class="p">))</span><span class="o">/</span><span class="n">dx</span>


<span class="k">def</span> <span class="nf">_variance</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Uses a more sophisticated variance calculation to speed up</span>
<span class="sd">    calculation of mean and standard deviation.</span>

<span class="sd">    :param *args: The variables we want to find the variance of.</span>
<span class="sd">    :type *args: tuple</span>
<span class="sd">    :param ddof: The degrees of freedom of the system.</span>
<span class="sd">    :type ddof: int</span>

<span class="sd">    :returns: The mean and standard deviation of a data array.</span>
<span class="sd">    :rtype: tuple</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">SumSq</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">Sum</span> <span class="o">+=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">SumSq</span> <span class="o">+=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">std</span> <span class="o">=</span> <span class="p">((</span><span class="n">SumSq</span><span class="o">-</span><span class="n">Sum</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">Sum</span><span class="o">/</span><span class="n">N</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">_weighted_variance</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculates the variance weighted mean and standard deviation.</span>

<span class="sd">    :param mean: The mean of the variable.</span>
<span class="sd">    :type mean: float</span>
<span class="sd">    :param std: The standard deviation of the variable.</span>
<span class="sd">    :type std: float</span>
<span class="sd">    :param ddof: The degrees of freedom of the system.</span>
<span class="sd">    :type ddof: int</span>

<span class="sd">    :returns: The variance weighted mean and standard deviation.</span>
<span class="sd">    :rtype: tuple</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">sqrt</span>

    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">w_mean</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">mean</span><span class="p">))</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">w_std</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">w_mean</span><span class="p">,</span> <span class="n">w_std</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">reset_variables</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Resets the ID number, directories and methods to their original values.</span>
<span class="sd">    Useful in Jupyter Notebooks if variables were unintentionally repeated.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">Measurement</span><span class="o">.</span><span class="n">id_number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Function</span><span class="o">.</span><span class="n">id_number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">register</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">formula_register</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">error_method</span> <span class="o">=</span> <span class="s2">&quot;Derivative&quot;</span>
    <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">mc_trial_number</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">print_style</span> <span class="o">=</span> <span class="s2">&quot;Default&quot;</span>
    <span class="n">ExperimentalValue</span><span class="o">.</span><span class="n">figs</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Connor Kapahi.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>